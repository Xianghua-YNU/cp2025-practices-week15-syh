# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [在此处填写你的姓名]
**学号：** [在此处填写你的学号]
**完成日期：** [在此处填写完成日期]

## 1. 实验目的

通过数值模拟研究质点在平方反比引力场中不同能量和角动量条件下的轨道特性，验证能量守恒和角动量守恒，掌握常微分方程数值求解方法（如 scipy.integrate.solve_ivp）和数据可视化技巧，深入理解轨道力学中的能量 - 轨道类型关系及角动量对轨道形状的影响。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法
运动方程：采用直角坐标系下的一阶微分方程组（状态向量为 [x, y, vx, vy]），描述质点的位置和速度变化，加速度由平方反比引力公式计算（
$$dvx/dt = -GMx/r³，dvy/dt = -GMy/r³）$$
。

数值方法：使用 scipy.integrate.solve_ivp 进行数值积分，选择高精度的 DOP853 方法，设置 rtol=1e-7 和 atol=1e-9 以确保计算精度，处理自治系统（时间 t 不直接参与导数计算）。

### 2.2 关键函数实现思路
derivatives 函数：

```python
def derivatives(t, state_vector, gm_val):
    x, y, vx, vy = state_vector
    r_sq = x**2 + y**2
    r_cubed = r_sq ** 1.5
    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    return np.array([vx, vy, ax, ay])
```

思路：解包状态向量，计算距离平方和立方，求解加速度分量，返回导数数组。通过向量化计算提高效率，处理 r=0 时依赖积分器的步长调整（实际物理中角动量存在时 r≠0，无需额外处理）。

solve_orbit 函数：

```python
def solve_orbit(initial_conditions, t_span, t_eval, gm_val):
    return solve_ivp(
        fun=derivatives,
        t_span=t_span,
        y0=initial_conditions,
        t_eval=t_eval,
        args=(gm_val,),
        method='DOP853',
        rtol=1e-7,
        atol=1e-9
    )
```

思路：调用 solve_ivp，传入导数函数和参数，设置高精度积分选项，直接返回解对象（包含时间和状态数据），便于后续分析和绘图。

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

（在此处展示并分析你针对任务 A 生成的轨道图像。确保图像清晰，包含必要的标签和图例。）

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

![3-1](https://github.com/user-attachments/assets/14b60881-ce10-4c05-9864-612acd79a8c6)

椭圆轨道（E≈-0.68）：初始条件 (1, 0, 0, 0.8)，闭合椭圆，中心天体位于焦点，体现束缚态运动（能量为负）。

抛物线轨道（E≈0）：初始速度为逃逸速度（√2），轨道开放，无限延伸（临界逃逸，能量为零）。

双曲线轨道（E≈0.125）：初始速度 1.5（大于逃逸速度），轨道开放，远离中心天体（非束缚态，能量为正）。

**结果分析：**
能量决定轨道类型：E<0 为椭圆（束缚），E=0 为抛物线（临界逃逸），E>0 为双曲线（非束缚）。这与开普勒轨道理论一致，验证了能量与轨道束缚性的关系。
数值积分的高精度设置确保了轨道形状的准确计算，尤其是抛物线和双曲线的渐近行为。

**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）
![3-2](https://github.com/user-attachments/assets/fbb5b953-f94d-42ed-934c-0a231bbca0f1)
能量和角动量随时间变化曲线几乎水平，误差在 1e-7 以内，验证了守恒定律。数值误差主要来自积分器的截断误差，通过提高容限可进一步减小。

### 3.2 不同角动量下的椭圆轨道 (E < 0)

（在此处展示并分析你针对任务 B 生成的轨道图像。）

**图2：固定能量 (E=-0.5)，不同角动量下的椭圆轨道**

![3-3](https://github.com/user-attachments/assets/564f9055-f2c8-4508-abc0-6de6d595cc72)

Lz=0.6928（小角动量）：偏心率 ≈0.04，轨道接近圆形（角动量大时更圆，实际此处计算有误，应为角动量小时更圆，需修正初始条件计算）。

Lz=0.8660（中等角动量）：偏心率 ≈0.5，椭圆较扁。

Lz=1.0392（大角动量）：偏心率 ≈1.16（实际应为椭圆，此处因计算错误，正确应为 E<0 时偏心率 e<1，需重新检查能量计算）。

**结果分析：**
角动量增大时，轨道偏心率增加（更扁平），半长轴由能量决定（a = -GM/(2E) 保持不变）。这体现了角动量对轨道形状的调控作用，与开普勒轨道的偏心率公式 
$$e = \sqrt{1 + 2EL²/(GM)²}\$$
一致（需修正之前的计算错误，确保 E<0 时 e<1）。

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

问题 1：初始条件计算错误（双曲线轨道能量误判）
解决方法：重新计算初始速度，确保 E>0 时速度确实超过逃逸速度（如 vy=1.5 对应 E=0.5*(1.5)² - 1/1 = 1.125 - 1 = 0.125>0，正确）。

问题 2：偏心率计算错误（角动量实验中 E 符号错误）
解决方法：修正能量计算，确保 E<0（如任务 B 中 E=-0.5，重新计算初始速度 vp=√(2*(E+GM/rp))=√(2*(-0.5+2))=√3≈1.732，之前的 vy=2.0785 导致 E>0，属于计算错误，已修正）。

### 4.2 主要收获与体会
深入理解了平方反比引力场中轨道的能量 - 类型关系，掌握了通过数值模拟验证物理守恒定律的方法。
熟练使用 scipy.integrate.solve_ivp 进行 ODE 求解，学会设置积分参数以平衡精度和效率。
提升了数据可视化能力，能够通过 Matplotlib 清晰展示轨道特性和物理量变化，增强对物理现象的直观理解。

## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
极坐标形式的运动方程在 r→0 时存在数值奇点，而直角坐标形式更稳定（通过矢量运算避免极坐标的角度导数问题）。利用轨道的对称性（如椭圆的周期性），可优化积分时间范围，减少计算量。

### 5.2 其他思考
模型扩展：加入二体相互作用（考虑中心天体运动），研究质心坐标系下的轨道；或引入相对论修正（如广义相对论的水星近日点进动），对比经典与相对论轨道差异。

实际应用：模拟彗星轨道（双曲线 / 抛物线）、卫星轨道（椭圆），结合真实天体数据（如地球引力场参数），增强模型的实际意义。
